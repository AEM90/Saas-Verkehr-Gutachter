{% extends "base.html" %}
{% load static %}
{% block title %}{{ messmethode.name }} â€” Fill Form{% endblock %}

{% block content %}
  <div class="form-card">
    <header style="display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:12px;">
      <div>
        <h2 style="margin:0 0 4px 0;">{{ messmethode.name }}</h2>
        {% if messmethode.description %}
          <div style="color:var(--neutral-500); font-size:13px;">{{ messmethode.description }}</div>
        {% endif %}
      </div>
      <div>
        <a class="action-btn" href="{% url 'core:landing' %}">Back</a>
      </div>
    </header>

    <form method="post" enctype="multipart/form-data" novalidate>
      {% csrf_token %}
      <div class="form-grid">
        {# Loop individual fields so we can style them cleanly #}
        {% for field in form %}
          <div class="form-row">
            {{ field.label_tag }}
            {% if field.errors %}
              {{ field }}
              <ul class="errorlist">
                {% for err in field.errors %}
                  <li>{{ err }}</li>
                {% endfor %}
              </ul>
            {% else %}
              {{ field }}
            {% endif %}
            {% if field.help_text %}
              <div class="helptext">{{ field.help_text }}</div>
            {% endif %}
          </div>
        {% endfor %}
      </div>

      {% if form.non_field_errors %}
        <ul class="errorlist">
          {% for err in form.non_field_errors %}
            <li>{{ err }}</li>
          {% endfor %}
        </ul>
      {% endif %}

      <div class="form-actions">
        <button type="submit" name="save" class="greenbutton">Save</button>
        <button type="submit" name="save_generate" class="action-btn primary">Save & Generate Report</button>
        <a href="{% url 'core:history' %}" class="action-btn">Cancel</a>
      </div>

      <div class="form-footer">
        <small>Fields marked with * are required. Files will be uploaded to the server.</small>
      </div>
    </form>
  </div>
{% endblock %}